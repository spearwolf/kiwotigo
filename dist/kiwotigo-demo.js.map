{"version":3,"file":"kiwotigo-demo.js","sources":["../kiwotigo.mjs","../kiwotigo-painter.mjs","../kiwotigo-demo.mjs"],"sourcesContent":["let worker\n\nlet lastBuild\nlet publishChannel\n\nexport const startBroadcasting = () => {\n  if (!publishChannel && typeof BroadcastChannel !== 'undefined') {\n    publishChannel = new BroadcastChannel('kiwotigo')\n    publishChannel.onmessage = ({ data }) => {\n      if (data) {\n        switch (data.type) {\n          case 'publishBuild':\n            if (lastBuild) {\n              publishChannel.postMessage(lastBuild)\n            }\n            break;\n          case 'ping':\n            publishChannel.postMessage({ type: 'pong' })\n            break;\n        }\n      }\n    }\n    if (lastBuild) {\n      publishChannel.postMessage(lastBuild)\n    }\n  }\n}\n\nconst tmpResolvers = new Map()  // temporary id -> resolve: Promise.resolve(), onProgressFn\n\nconst createMessageId = (() => {\n  let lastId = 0\n  return () => {\n    ++lastId\n    return `kiwotigo-${lastId.toString(36)}`\n  }\n})()\n\nconst initWorker = () => {\n  worker = new Worker('kiwotigo.worker.js')\n\n  worker.onmessage = ({data}) => {\n    const { id, type } = data\n    const resolve = tmpResolvers.get(id)\n    if (resolve) {\n      switch (type) {\n        case 'progress':\n          if (resolve.onProgressFn) {\n            resolve.onProgressFn(data.progress)\n          }\n          break\n\n        case 'result':\n          tmpResolvers.delete(id)\n          delete data.type\n          if (data.originData) {\n            localStorage.setItem('kiwotigoOriginData',\n              typeof data.originData === 'string'\n                ? data.originData\n                : JSON.stringify(data.originData)\n            )\n          }\n          resolve.resolve(data)\n          if (publishChannel) {\n            lastBuild = { type: 'build', data }\n            publishChannel.postMessage(lastBuild)\n          }\n          break\n\n        default:\n          console.warn('unknown message type:', type, data)\n      }\n    }\n  }\n}\n\nconst getWorker = () => {\n  if (!worker) {\n    initWorker()\n  }\n  return worker\n}\n\nexport const build = (config, onProgressFn) => new Promise(resolve => {\n  const id = createMessageId()\n  tmpResolvers.set(id, { resolve, onProgressFn })\n  getWorker().postMessage({ ...config, id })\n})\n","const REGION_OUTLINE_STROKE = '#a5a5a5';\nconst REGION_BASE_PATH_FILL = '#e7e7e7';\nconst REGION_FULL_PATH_FILL = '#f5f5f5';\nconst REGION_RADIUS_STROKE = '#a9a9a9';\nconst REGION_BBOX_STROKE = '#f0f0f0';\nconst REGION_OUTER_RADIUS_STROKE = '#cacaca';\nconst CONNECTION_STROKE = '#f5b';\n\nfunction clearCanvas(ctx) {\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n}\n\nfunction drawPath(ctx, regions, pathName, stroke = false) {\n  regions.forEach((region) => {\n    const path = region[pathName];\n\n    ctx.beginPath();\n    ctx.moveTo(path[0], path[1]);\n    const len = path.length >> 1;\n    for (let i = 1; i < len; i++) {\n      ctx.lineTo(path[i << 1], path[(i << 1) + 1]);\n    }\n    ctx.closePath();\n\n    ctx.fill();\n    if (stroke) {\n      ctx.stroke();\n    }\n  });\n}\n\nfunction drawRegions(ctx, continent, drawBasePath) {\n  ctx.strokeStyle = REGION_OUTLINE_STROKE;\n  ctx.lineWidth = 1;\n\n  ctx.fillStyle = REGION_FULL_PATH_FILL;\n  drawPath(ctx, continent.regions, 'fullPath', true);\n\n  if (drawBasePath) {\n    ctx.fillStyle = REGION_BASE_PATH_FILL;\n    drawPath(ctx, continent.regions, 'basePath');\n  }\n}\n\nfunction drawRegionsBase(ctx, continent) {\n  ctx.lineWidth = 1;\n\n  continent.regions.forEach(({ centerPoint: cp }) => {\n    ctx.strokeStyle = REGION_RADIUS_STROKE;\n    ctx.setLineDash([]);\n    ctx.beginPath();\n    ctx.arc(cp.x, cp.y, cp.iR, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    ctx.stroke();\n\n    ctx.strokeStyle = REGION_OUTER_RADIUS_STROKE;\n    ctx.setLineDash([5, 15, 25]);\n    ctx.beginPath();\n    ctx.arc(cp.x, cp.y, cp.oR, 0, 2 * Math.PI, false);\n    ctx.closePath();\n    ctx.stroke();\n  });\n}\n\nconst getRegion = (continent, regionIdx) => continent.regions[regionIdx];\n\nfunction drawRegionsConnections(ctx, continent) {\n  ctx.setLineDash([]);\n  ctx.strokeStyle = CONNECTION_STROKE;\n  ctx.lineWidth = 3;\n\n  const alreadyDrawnConnection = new Set();\n\n  continent.regions.forEach((region) => {\n    region.neighbors.forEach((neighborId) => {\n      const connectionId =\n        region.id < neighborId\n          ? `${region.id};${neighborId}`\n          : `${neighborId};${region.id}`;\n      if (!alreadyDrawnConnection.has(connectionId)) {\n        alreadyDrawnConnection.add(connectionId);\n        const otherRegion = getRegion(continent, neighborId);\n        const isAnotherIsland = region.islandId !== otherRegion.islandId;\n\n        ctx.setLineDash(isAnotherIsland ? [3, 6] : []);\n        ctx.beginPath();\n        ctx.moveTo(region.centerPoint.x, region.centerPoint.y);\n        ctx.lineTo(otherRegion.centerPoint.x, otherRegion.centerPoint.y);\n        ctx.closePath();\n        ctx.stroke();\n      }\n    });\n  });\n\n  ctx.setLineDash([]);\n}\n\nfunction drawRegionIds(ctx, continent) {\n  ctx.font = 'bold 36px sans-serif';\n  ctx.shadowColor = '#fff';\n  ctx.shadowOffsetX = 0;\n  ctx.shadowOffsetY = 0;\n  ctx.shadowBlur = 4;\n  ctx.textAlign = 'center';\n  ctx.textBaseline = 'middle';\n  ctx.fillStyle = '#666';\n\n  continent.regions.forEach(({ centerPoint: { x, y } }, i) => {\n    ctx.fillText(`${i}`, x, y);\n  });\n}\n\nfunction drawBoundingBoxes(ctx, { regions }) {\n  ctx.strokeStyle = REGION_BBOX_STROKE;\n  regions.forEach(({ bBox }) => {\n    ctx.beginPath();\n    ctx.rect(bBox.left, bBox.top, bBox.width, bBox.height);\n    ctx.stroke();\n  });\n}\n\nexport default function draw({ ctx, icf, ...cfg }) {\n  clearCanvas(ctx);\n  if (cfg.drawRegionBoundingBoxes) {\n    drawBoundingBoxes(ctx, icf);\n  }\n  drawRegions(ctx, icf, cfg.drawRegionBasePaths);\n  if (cfg.drawRegionsBase) {\n    drawRegionsBase(ctx, icf);\n  }\n  if (cfg.drawRegionConnections) {\n    drawRegionsConnections(ctx, icf);\n  }\n  if (cfg.drawRegionIds) {\n    drawRegionIds(ctx, icf);\n  }\n}\n","import { build, startBroadcasting } from \"./kiwotigo.mjs\";\nimport draw from \"./kiwotigo-painter.mjs\";\n\nconst canvas = document.getElementById(\"kiwotigoCanvas\");\nconst canvasCtx = canvas.getContext(\"2d\");\n\nconst loadingMessages = [\n  \"I will now create a new world just for you ...\",\n  \"Such a thing can take a while, though ...\",\n  \"... each country must be carefully considered ...\",\n  \"Hold on, it can't be much longer ...\",\n  \"I'm almost finished, there's just a few final touches ...\",\n];\n\nconst displayLoadingInfo = (html) => {\n  document.querySelector(\".loadingModal-info\").innerHTML = html;\n};\n\nlet currentLoadingMessageIdx = 0;\nlet displayNextLoadingMessageHandle = 0;\n\nconst showLoadingState = () => {\n  displayLoadingInfo(loadingMessages[0]);\n  currentLoadingMessageIdx = 1;\n  document.querySelector(\".loadingModal\").classList.add(\"loading\");\n  clearInterval(displayNextLoadingMessageHandle);\n  displayNextLoadingMessageHandle = setInterval(() => {\n    displayLoadingInfo(loadingMessages[currentLoadingMessageIdx]);\n    currentLoadingMessageIdx =\n      (currentLoadingMessageIdx + 1) % loadingMessages.length;\n  }, 5000);\n};\n\nconst displayProgress = (progress) => {\n  const maxWidth = document\n    .querySelector(\".loadingModal-content\")\n    .getBoundingClientRect().width;\n  const el = document.querySelector(\".loadingModal-progress\");\n  el.style.width = `${Math.round(progress * maxWidth)}px`;\n};\n\nconst hideLoadingState = () => {\n  clearInterval(displayNextLoadingMessageHandle);\n  displayProgress(1);\n  setTimeout(() => {\n    document.querySelector(\".loadingModal\").classList.remove(\"loading\");\n  }, 500);\n};\n\nconst getUpdateToggleAction = () =>\n  document.querySelector(\".kiwotigo-form-justUpdate\");\n\nconst getMapLegendOptions = () => {\n  const legendOptions = {};\n  Array.from(\n    document.querySelectorAll(\".mapLegendContainer input[type=checkbox]\")\n  ).forEach((checkbox) => {\n    legendOptions[checkbox.name] = checkbox.checked;\n  });\n  return legendOptions;\n};\n\nconst drawContinent = (() => {\n  let drawOptions;\n\n  return (options) => {\n    drawOptions = { ...drawOptions, ...options, ...getMapLegendOptions() };\n    draw(drawOptions);\n  };\n})();\n\nconst onCreate = (config) => {\n  showLoadingState();\n\n  build(config, displayProgress).then((data) => {\n    console.log(\"received new build\", data);\n    hideLoadingState();\n    getUpdateToggleAction().disabled = false;\n    document.querySelector(\".mapLegendContainer\").style.display = \"block\";\n\n    canvas.width = data.continent.canvasWidth;\n    canvas.height = data.continent.canvasHeight;\n    // const DPR = window.devicePixelRatio || 1;\n    // if (DPR !== 1) {\n    //   canvas.style.width = `${Math.round(canvas.width / DPR)}px`;\n    //   canvas.style.height = `${Math.round(canvas.height / DPR)}px`;\n    // }\n    drawContinent({ ctx: canvasCtx, icf: data.continent });\n  });\n};\n\nconst getConfig = () => {\n  const { elements: formElements } = document.forms.kiwotigo;\n  return [\n    \"gridWidth\",\n    \"gridHeight\",\n    \"gridOuterPaddingX\",\n    \"gridOuterPaddingY\",\n    \"gridInnerPaddingX\",\n    \"gridInnerPaddingY\",\n    \"gridHexWidth\",\n    \"gridHexHeight\",\n    \"hexWidth\",\n    \"hexHeight\",\n    \"hexPaddingX\",\n    \"hexPaddingY\",\n    \"minimalGrowIterations\",\n    \"fastGrowIterations\",\n    \"maxRegionSizeFactor\",\n    \"probabilityCreateRegionAt\",\n    // \"enableExtendedConnections\",\n    \"maxExtendedOuterRangeFactor\",\n    \"canvasMargin\",\n  ].reduce((c, key) => ({ ...c, [key]: parseFloat(formElements[key].value) }), {\n    // swapXY: true,\n  });\n};\n\nconst getKiwotigoOriginData = () => localStorage.getItem(\"kiwotigoOriginData\");\n\ndocument.forms.kiwotigo.addEventListener(\"submit\", (event) => {\n  event.preventDefault();\n\n  if (getUpdateToggleAction().checked) {\n    onCreate({ ...getConfig(), originData: getKiwotigoOriginData() });\n  } else {\n    onCreate(getConfig());\n  }\n\n  document.querySelector(\".kiwotigo-createContinentBtn\").blur();\n});\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const originData = getKiwotigoOriginData();\n  if (originData) {\n    getUpdateToggleAction().disabled = false;\n    const originConfig = JSON.parse(originData).config;\n    onCreate({ ...originConfig, originData });\n    Array.from(Object.entries(originConfig)).forEach(([key, value]) => {\n      const el = document.querySelector(`.kiwotigo-form input[name=${key}]`);\n      if (el) {\n        el.value = value;\n      }\n    });\n  } else {\n    getUpdateToggleAction().disabled = true;\n    document.querySelector(\".mapLegendContainer\").style.display = \"none\";\n  }\n});\n\ndocument.querySelector(\".openCloseAction\").addEventListener(\"pointerup\", () => {\n  document.querySelector(\".createContinentConfig\").classList.toggle(\"opened\");\n});\n\ngetUpdateToggleAction().addEventListener(\"change\", () => {\n  const { checked } = getUpdateToggleAction();\n  Array.from(\n    document.querySelectorAll(\".kiwotigo-form .create-only input\")\n  ).forEach((el) => {\n    el.disabled = checked;\n  });\n  document\n    .querySelector(\".kiwotigo-form\")\n    .classList[checked ? \"add\" : \"remove\"](\"just-update\");\n});\n\ndocument.querySelector(\".mapLegendContainer\").addEventListener(\"change\", () => {\n  console.debug(\"legend options\", getMapLegendOptions());\n  drawContinent(getMapLegendOptions());\n});\n\ndocument.body.addEventListener(\"pointerup\", (event) => {\n  const el = event.target;\n  if (el.tagName === \"LABEL\") {\n    const labelTarget = el.getAttribute(\"for\");\n    const targetInput = document.querySelector(`input[name=${labelTarget}]`);\n    if (targetInput && targetInput.type === \"checkbox\") {\n      targetInput.click();\n    }\n  }\n});\n\nstartBroadcasting();\n"],"names":["worker","lastBuild","publishChannel","tmpResolvers","Map","createMessageId","lastId","toString","getWorker","Worker","onmessage","_ref2","data","id","type","resolve","get","onProgressFn","progress","delete","originData","localStorage","setItem","JSON","stringify","postMessage","console","warn","drawPath","ctx","regions","pathName","stroke","forEach","region","path","beginPath","moveTo","len","length","i","lineTo","closePath","fill","draw","icf","cfg","clearRect","canvas","width","height","clearCanvas","drawRegionBoundingBoxes","strokeStyle","_ref4","bBox","rect","left","top","drawBoundingBoxes","continent","drawBasePath","lineWidth","fillStyle","drawRegions","drawRegionBasePaths","drawRegionsBase","_ref","centerPoint","cp","setLineDash","arc","x","y","iR","Math","PI","oR","drawRegionConnections","alreadyDrawnConnection","Set","neighbors","neighborId","connectionId","has","add","otherRegion","regionIdx","getRegion","isAnotherIsland","islandId","drawRegionsConnections","drawRegionIds","font","shadowColor","shadowOffsetX","shadowOffsetY","shadowBlur","textAlign","textBaseline","fillText","document","getElementById","canvasCtx","getContext","loadingMessages","displayLoadingInfo","html","querySelector","innerHTML","currentLoadingMessageIdx","displayNextLoadingMessageHandle","displayProgress","maxWidth","getBoundingClientRect","style","round","getUpdateToggleAction","getMapLegendOptions","legendOptions","Array","from","querySelectorAll","checkbox","name","checked","drawContinent","drawOptions","options","onCreate","config","classList","clearInterval","setInterval","Promise","set","build","then","log","setTimeout","remove","disabled","display","canvasWidth","canvasHeight","getConfig","elements","formElements","forms","kiwotigo","reduce","c","key","parseFloat","value","getKiwotigoOriginData","getItem","addEventListener","event","preventDefault","blur","originConfig","parse","Object","entries","el","toggle","debug","body","target","tagName","labelTarget","getAttribute","targetInput","click","BroadcastChannel"],"mappings":"yBAAA,IAAIA,EAEAC,EACAC,EAEG,MAuBDC,EAAe,IAAIC,IAEnBC,EAAkB,UAClBC,EAAS,QACN,OACHA,qBACiBA,EAAOC,SAAS,OAJf,GA8ClBC,EAAY,KACXR,IAtCLA,EAAS,IAAIS,OAAO,sBAEpBT,EAAOU,UAAYC,QAACC,KAACA,WACbC,GAAEA,EAAFC,KAAMA,GAASF,EACfG,EAAUZ,EAAaa,IAAIH,MAC7BE,SACMD,OACD,WACCC,EAAQE,cACVF,EAAQE,aAAaL,EAAKM,oBAIzB,SACHf,EAAagB,OAAON,UACbD,EAAKE,KACRF,EAAKQ,YACPC,aAAaC,QAAQ,qBACQ,iBAApBV,EAAKQ,WACRR,EAAKQ,WACLG,KAAKC,UAAUZ,EAAKQ,aAG5BL,EAAQA,QAAQH,GACZV,IACFD,EAAY,CAAEa,KAAM,QAASF,KAAAA,GAC7BV,EAAeuB,YAAYxB,kBAK7ByB,QAAQC,KAAK,wBAAyBb,EAAMF,MAU7CZ,GCpET,SAAS4B,EAASC,EAAKC,EAASC,OAAUC,0DACxCF,EAAQG,QAASC,UACTC,EAAOD,EAAOH,GAEpBF,EAAIO,YACJP,EAAIQ,OAAOF,EAAK,GAAIA,EAAK,UACnBG,EAAMH,EAAKI,QAAU,MACtB,IAAIC,EAAI,EAAGA,EAAIF,EAAKE,IACvBX,EAAIY,OAAON,EAAKK,GAAK,GAAIL,EAAgB,GAAVK,GAAK,KAEtCX,EAAIa,YAEJb,EAAIc,OACAX,GACFH,EAAIG,WA+FK,SAASY,SAAKf,IAAEA,EAAFgB,IAAOA,KAAQC,MAjH5C,SAAqBjB,GACnBA,EAAIkB,UAAU,EAAG,EAAGlB,EAAImB,OAAOC,MAAOpB,EAAImB,OAAOE,QAiHjDC,CAAYtB,GACRiB,EAAIM,yBAXV,SAA2BvB,SAAKC,QAAEA,KAChCD,EAAIwB,YA7GqB,UA8GzBvB,EAAQG,QAAQqB,QAACC,KAAEA,KACjB1B,EAAIO,YACJP,EAAI2B,KAAKD,EAAKE,KAAMF,EAAKG,IAAKH,EAAKN,MAAOM,EAAKL,QAC/CrB,EAAIG,WAOJ2B,CAAkB9B,EAAKgB,GA7F3B,SAAqBhB,EAAK+B,EAAWC,GACnChC,EAAIwB,YAhCwB,UAiC5BxB,EAAIiC,UAAY,EAEhBjC,EAAIkC,UAjCwB,UAkC5BnC,EAASC,EAAK+B,EAAU9B,QAAS,YAAY,GAEzC+B,IACFhC,EAAIkC,UAtCsB,UAuC1BnC,EAASC,EAAK+B,EAAU9B,QAAS,aAsFnCkC,CAAYnC,EAAKgB,EAAKC,EAAImB,qBACtBnB,EAAIoB,iBAnFV,SAAyBrC,EAAK+B,GAC5B/B,EAAIiC,UAAY,EAEhBF,EAAU9B,QAAQG,QAAQkC,QAAGC,YAAaC,KACxCxC,EAAIwB,YA7CqB,UA8CzBxB,EAAIyC,YAAY,IAChBzC,EAAIO,YACJP,EAAI0C,IAAIF,EAAGG,EAAGH,EAAGI,EAAGJ,EAAGK,GAAI,EAAG,EAAIC,KAAKC,IAAI,GAC3C/C,EAAIa,YACJb,EAAIG,SAEJH,EAAIwB,YAlD2B,UAmD/BxB,EAAIyC,YAAY,CAAC,EAAG,GAAI,KACxBzC,EAAIO,YACJP,EAAI0C,IAAIF,EAAGG,EAAGH,EAAGI,EAAGJ,EAAGQ,GAAI,EAAG,EAAIF,KAAKC,IAAI,GAC3C/C,EAAIa,YACJb,EAAIG,WAoEJkC,CAAgBrC,EAAKgB,GAEnBC,EAAIgC,uBAhEV,SAAgCjD,EAAK+B,GACnC/B,EAAIyC,YAAY,IAChBzC,EAAIwB,YA9DoB,OA+DxBxB,EAAIiC,UAAY,QAEViB,EAAyB,IAAIC,IAEnCpB,EAAU9B,QAAQG,QAASC,IACzBA,EAAO+C,UAAUhD,QAASiD,UAClBC,EACJjD,EAAOrB,GAAKqE,YACLhD,EAAOrB,eAAMqE,aACbA,cAAchD,EAAOrB,QACzBkE,EAAuBK,IAAID,GAAe,CAC7CJ,EAAuBM,IAAIF,SACrBG,EAjBI,EAAC1B,EAAW2B,IAAc3B,EAAU9B,QAAQyD,GAiBlCC,CAAU5B,EAAWsB,GACnCO,EAAkBvD,EAAOwD,WAAaJ,EAAYI,SAExD7D,EAAIyC,YAAYmB,EAAkB,CAAC,EAAG,GAAK,IAC3C5D,EAAIO,YACJP,EAAIQ,OAAOH,EAAOkC,YAAYI,EAAGtC,EAAOkC,YAAYK,GACpD5C,EAAIY,OAAO6C,EAAYlB,YAAYI,EAAGc,EAAYlB,YAAYK,GAC9D5C,EAAIa,YACJb,EAAIG,cAKVH,EAAIyC,YAAY,IAqCdqB,CAAuB9D,EAAKgB,GAE1BC,EAAI8C,eApCV,SAAuB/D,EAAK+B,GAC1B/B,EAAIgE,KAAO,uBACXhE,EAAIiE,YAAc,OAClBjE,EAAIkE,cAAgB,EACpBlE,EAAImE,cAAgB,EACpBnE,EAAIoE,WAAa,EACjBpE,EAAIqE,UAAY,SAChBrE,EAAIsE,aAAe,SACnBtE,EAAIkC,UAAY,OAEhBH,EAAU9B,QAAQG,QAAQ,GAA4BO,SAAzB4B,aAAaI,EAAEA,EAAFC,EAAKA,MAC7C5C,EAAIuE,mBAAY5D,GAAKgC,EAAGC,KA0BxBmB,CAAc/D,EAAKgB,GCnIvB,MAAMG,EAASqD,SAASC,eAAe,kBACjCC,EAAYvD,EAAOwD,WAAW,MAE9BC,EAAkB,CACtB,iDACA,4CACA,oDACA,uCACA,6DAGIC,EAAsBC,IAC1BN,SAASO,cAAc,sBAAsBC,UAAYF,GAG3D,IAAIG,EAA2B,EAC3BC,EAAkC,EAEtC,MAYMC,EAAmB9F,UACjB+F,EAAWZ,SACdO,cAAc,yBACdM,wBAAwBjE,MAChBoD,SAASO,cAAc,0BAC/BO,MAAMlE,gBAAW0B,KAAKyC,MAAMlG,EAAW+F,UAWtCI,EAAwB,IAC5BhB,SAASO,cAAc,6BAEnBU,EAAsB,WACpBC,EAAgB,UACtBC,MAAMC,KACJpB,SAASqB,iBAAiB,6CAC1BzF,QAAS0F,IACTJ,EAAcI,EAASC,MAAQD,EAASE,UAEnCN,GAGHO,EAAgB,UAChBC,SAEIC,IACND,EAAc,IAAKA,KAAgBC,KAAYV,KAC/C1E,EAAKmF,KALa,GAShBE,EAAYC,IAjDhBxB,EAAmBD,EAAgB,IACnCK,EAA2B,EAC3BT,SAASO,cAAc,iBAAiBuB,UAAU9C,IAAI,WACtD+C,cAAcrB,GACdA,EAAkCsB,YAAY,KAC5C3B,EAAmBD,EAAgBK,IACnCA,GACGA,EAA2B,GAAKL,EAAgBlE,QAClD,KFqDgB,EAAC2F,EAAQjH,IAAiB,IAAIqH,QAAQvH,UACnDF,EAAKR,IACXF,EAAaoI,IAAI1H,EAAI,CAAEE,QAAAA,EAASE,aAAAA,IAChCT,IAAYiB,YAAY,IAAKyG,EAAQrH,GAAAA,MEZrC2H,CAAMN,EAAQlB,GAAiByB,KAAM7H,IACnCc,QAAQgH,IAAI,qBAAsB9H,GAjCpCwH,cAAcrB,GACdC,EAAgB,GAChB2B,WAAW,KACTtC,SAASO,cAAc,iBAAiBuB,UAAUS,OAAO,YACxD,KA+BDvB,IAAwBwB,UAAW,EACnCxC,SAASO,cAAc,uBAAuBO,MAAM2B,QAAU,QAE9D9F,EAAOC,MAAQrC,EAAKgD,UAAUmF,YAC9B/F,EAAOE,OAAStC,EAAKgD,UAAUoF,aAM/BlB,EAAc,CAAEjG,IAAK0E,EAAW1D,IAAKjC,EAAKgD,eAIxCqF,EAAY,WACRC,SAAUC,GAAiB9C,SAAS+C,MAAMC,eAC3C,CACL,YACA,aACA,oBACA,oBACA,oBACA,oBACA,eACA,gBACA,WACA,YACA,cACA,cACA,wBACA,qBACA,sBACA,0DAGA,gBACAC,OAAO,CAACC,EAAGC,SAAcD,GAAIC,GAAMC,WAAWN,EAAaK,GAAKE,SAAW,KAKzEC,EAAwB,IAAMtI,aAAauI,QAAQ,sBAEzDvD,SAAS+C,MAAMC,SAASQ,iBAAiB,SAAWC,IAClDA,EAAMC,iBAEF1C,IAAwBQ,QAC1BI,EAAS,IAAKgB,IAAa7H,WAAYuI,MAEvC1B,EAASgB,KAGX5C,SAASO,cAAc,gCAAgCoD,SAGzD3D,SAASwD,iBAAiB,mBAAoB,WACtCzI,EAAauI,OACfvI,EAAY,CACdiG,IAAwBwB,UAAW,QAC7BoB,EAAe1I,KAAK2I,MAAM9I,GAAY8G,OAC5CD,EAAS,IAAKgC,EAAc7I,WAAAA,IAC5BoG,MAAMC,KAAK0C,OAAOC,QAAQH,IAAehI,QAAQkC,QAAEqF,EAAKE,WAChDW,EAAKhE,SAASO,kDAA2C4C,QAC3Da,IACFA,EAAGX,MAAQA,UAIfrC,IAAwBwB,UAAW,EACnCxC,SAASO,cAAc,uBAAuBO,MAAM2B,QAAU,SAIlEzC,SAASO,cAAc,oBAAoBiD,iBAAiB,YAAa,KACvExD,SAASO,cAAc,0BAA0BuB,UAAUmC,OAAO,YAGpEjD,IAAwBwC,iBAAiB,SAAU,WAC3ChC,QAAEA,GAAYR,IACpBG,MAAMC,KACJpB,SAASqB,iBAAiB,sCAC1BzF,QAASoI,IACTA,EAAGxB,SAAWhB,IAEhBxB,SACGO,cAAc,kBACduB,UAAUN,EAAU,MAAQ,UAAU,iBAG3CxB,SAASO,cAAc,uBAAuBiD,iBAAiB,SAAU,KACvEnI,QAAQ6I,MAAM,iBAAkBjD,KAChCQ,EAAcR,OAGhBjB,SAASmE,KAAKX,iBAAiB,YAAcC,UACrCO,EAAKP,EAAMW,UACE,UAAfJ,EAAGK,QAAqB,OACpBC,EAAcN,EAAGO,aAAa,OAC9BC,EAAcxE,SAASO,mCAA4B+D,QACrDE,GAAoC,aAArBA,EAAY/J,MAC7B+J,EAAYC,WF3KX5K,GAA8C,oBAArB6K,mBAC5B7K,EAAiB,IAAI6K,iBAAiB,YACtC7K,EAAeQ,UAAYyD,QAACvD,KAAEA,QACxBA,SACMA,EAAKE,UACN,eACCb,GACFC,EAAeuB,YAAYxB,aAG1B,OACHC,EAAeuB,YAAY,CAAEX,KAAM,WAKvCb,GACFC,EAAeuB,YAAYxB"}